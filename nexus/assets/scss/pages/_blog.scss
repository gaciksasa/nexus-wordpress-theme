// =============================================================================
// Blog
// =============================================================================

@use '../abstracts/variables' as *;
@use '../abstracts/mixins' as *;

// -------------------------------------------------------------------------
// Archive / Blog page
// -------------------------------------------------------------------------
.nexus-blog-archive {
	padding-block: clamp(2rem, 4vw, 4rem);

	&__inner {
		display: grid;
		grid-template-columns: 1fr 300px;
		gap: 3rem;
		align-items: start;

		&.full-width {
			grid-template-columns: 1fr;
		}

		&.sidebar-left {
			grid-template-columns: 300px 1fr;

			@include respond-below(lg) {
				grid-template-columns: 1fr;
			}
		}

		@include respond-below(lg) {
			grid-template-columns: 1fr;
		}
	}
}

.nexus-posts-grid {
	display: grid;
	gap: 2rem;

	&.columns-2 { grid-template-columns: repeat(2, 1fr); }
	&.columns-3 { grid-template-columns: repeat(3, 1fr); }

	@include respond-below(md) {
		grid-template-columns: 1fr !important;
	}
}

// -------------------------------------------------------------------------
// Blog grid (Elementor widget: .nexus-blog-grid)
// -------------------------------------------------------------------------
.nexus-blog-grid {
	display: grid;
	grid-template-columns: repeat(var(--nexus-blog-cols, 3), 1fr);
	gap: 1.875rem;

	@include respond-below(lg) {
		grid-template-columns: repeat(2, 1fr);
	}

	@include respond-below(sm) {
		grid-template-columns: 1fr;
	}
}

// -------------------------------------------------------------------------
// Post card
// -------------------------------------------------------------------------
.nexus-post-card {
	background-color: var(--nexus-bg);
	border-radius: var(--nexus-border-radius-lg);
	overflow: hidden;
	border: 1px solid var(--nexus-border-color);
	transition: transform 0.32s ease, box-shadow 0.32s ease, border-color 0.32s ease;
	display: flex;
	flex-direction: column;

	&:hover {
		transform: translateY(-6px);
		box-shadow: 0 20px 48px rgba(0 0 0 / 0.11);
		border-color: transparent;
	}

	// ---- Thumbnail wrapper (now a <div>) ----
	&__thumb {
		display: block;
		overflow: hidden;
		aspect-ratio: 16/10;
		position: relative;
		flex-shrink: 0;
		background: var(--nexus-bg-subtle);
	}

	// Image link inside thumb wrapper
	&__thumb-link {
		display: block;
		width: 100%;
		height: 100%;

		img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			transition: transform 0.6s ease-out;
			display: block;
		}
	}

	&:hover &__thumb-link img {
		transform: scale(1.07);
	}

	// Placeholder when no featured image is set
	&__thumb-placeholder {
		display: flex;
		align-items: center;
		justify-content: center;
		background: var(--ph-color, var(--nexus-color-primary));
		text-decoration: none;
	}

	&__thumb-initial {
		font-size: clamp(2.5rem, 6vw, 4rem);
		font-weight: 800;
		font-family: var(--nexus-font-heading);
		color: rgba(255 255 255 / 0.25);
		line-height: 1;
		text-transform: uppercase;
		letter-spacing: -0.02em;
		user-select: none;
	}

	// Dark gradient overlay that fades in on hover
	&__img-overlay {
		position: absolute;
		inset: 0;
		background: linear-gradient(to top, rgba(0 0 0 / 0.5) 0%, transparent 55%);
		opacity: 0;
		transition: opacity 0.4s ease;
		pointer-events: none;
	}

	&:hover &__img-overlay {
		opacity: 1;
	}

	// Category badge — overlaid on image top-left
	&__cat-badge {
		position: absolute;
		top: 0.875rem;
		inset-inline-start: 0.875rem;
		z-index: 2;
		display: inline-flex;
		align-items: center;
		font-size: 0.6875rem;
		font-weight: 700;
		text-transform: uppercase;
		letter-spacing: 0.08em;
		color: #fff;
		background: var(--nexus-color-secondary);
		padding: 0.2rem 0.625rem;
		border-radius: var(--nexus-border-radius-sm);
		text-decoration: none;
		transition: background-color 0.2s ease;

		&:hover {
			background: #c73652;
		}
	}

	// Reading-time badge — overlaid on image top-right
	&__time {
		position: absolute;
		top: 0.875rem;
		inset-inline-end: 0.875rem;
		z-index: 2;
		display: inline-flex;
		align-items: center;
		gap: 0.25rem;
		font-size: 0.6875rem;
		font-weight: 600;
		color: rgba(255 255 255 / 0.92);
		background: rgba(0 0 0 / 0.48);
		backdrop-filter: blur(4px);
		padding: 0.2rem 0.5rem;
		border-radius: var(--nexus-border-radius-sm);
	}

	// ---- Body ----
	&__body {
		padding: 1.5rem;
		display: flex;
		flex-direction: column;
		flex: 1;
	}

	// ---- Meta (date · author) ----
	&__meta {
		display: flex;
		align-items: center;
		gap: 0.4rem;
		font-size: 0.8rem;
		color: var(--nexus-text-muted);
		margin-block-end: 0.625rem;
		flex-wrap: wrap;
	}

	&__sep {
		color: var(--nexus-border-color);
	}

	&__date,
	&__author {
		display: inline-flex;
		align-items: center;
		gap: 0.25rem;
	}

	&__author a {
		color: inherit;
		text-decoration: none;
		transition: color 0.2s ease;

		&:hover {
			color: var(--nexus-color-secondary);
		}
	}

	// ---- Title ----
	&__title {
		font-size: 1.125rem;
		line-height: 1.4;
		margin-block: 0 0.875rem;

		a {
			color: var(--nexus-heading-color);
			text-decoration: none;
			// Animated underline: slides in from left on hover
			background-image: linear-gradient(var(--nexus-color-secondary), var(--nexus-color-secondary));
			background-repeat: no-repeat;
			background-position: 0 100%;
			background-size: 0% 2px;
			transition: background-size 0.35s ease, color 0.2s ease;

			&:hover {
				color: var(--nexus-color-secondary);
				background-size: 100% 2px;
			}
		}
	}

	// ---- Excerpt ----
	&__excerpt {
		font-size: 0.9rem;
		line-height: 1.75;
		color: var(--nexus-text-secondary);
		margin-block-end: 1.25rem;
		flex: 1;

		@include truncate(3);
	}

	// ---- Read more ----
	&__more {
		display: inline-flex;
		align-items: center;
		gap: 0.375rem;
		font-size: 0.75rem;
		font-weight: 700;
		color: var(--nexus-color-secondary);
		text-decoration: none;
		text-transform: uppercase;
		letter-spacing: 0.07em;
		padding-block-end: 2px;
		border-block-end: 2px solid rgba(233 69 96 / 0.28);
		transition: border-color 0.25s ease, gap 0.2s ease;
		align-self: flex-start;
		margin-block-start: auto;

		i,
		svg {
			transition: transform 0.2s ease;
		}

		&:hover {
			border-color: var(--nexus-color-secondary);
			gap: 0.6rem;

			i,
			svg {
				transform: translateX(4px);
			}
		}
	}
}

// -------------------------------------------------------------------------
// Card layout variants (class on the grid wrapper)
// -------------------------------------------------------------------------

// Overlay — content floats over image bottom
.nexus-blog--overlay .nexus-post-card {
	position: relative;

	.nexus-post-card__thumb {
		aspect-ratio: 4/3;
	}

	.nexus-post-card__img-overlay {
		background: linear-gradient(to top, rgba(0 0 0 / 0.88) 0%, rgba(0 0 0 / 0.2) 55%, transparent 100%);
		opacity: 1;
	}

	.nexus-post-card__body {
		position: absolute;
		inset-inline: 0;
		bottom: 0;
		padding: 1.375rem;
		background: none;
		color: #fff;
	}

	.nexus-post-card__title a {
		color: #fff;
		background-image: linear-gradient(rgba(255 255 255 / 0.8), rgba(255 255 255 / 0.8));

		&:hover {
			color: #fff;
		}
	}

	.nexus-post-card__meta,
	.nexus-post-card__excerpt {
		color: rgba(255 255 255 / 0.78);
	}

	.nexus-post-card__more {
		color: #fff;
		border-color: rgba(255 255 255 / 0.35);

		&:hover {
			border-color: #fff;
		}
	}
}

// Minimal — no border/shadow, just a top divider line
.nexus-blog--minimal .nexus-post-card {
	border: none;
	border-radius: 0;
	border-block-start: 1px solid var(--nexus-border-color);
	padding-block: 1.5rem;
	background: none;

	&:hover {
		transform: none;
		box-shadow: none;
		border-color: var(--nexus-border-color);
	}

	.nexus-post-card__body {
		padding: 0.75rem 0 0;
	}

	.nexus-post-card__thumb {
		border-radius: var(--nexus-border-radius);
	}
}

// -------------------------------------------------------------------------
// Featured layout — first card spans 2 of 3 columns
// -------------------------------------------------------------------------
.nexus-blog--featured.nexus-blog-grid {
	grid-template-columns: repeat(3, 1fr);

	.nexus-post-card--featured {
		grid-column: 1 / 3;

		.nexus-post-card__thumb {
			aspect-ratio: 16/9;
		}

		.nexus-post-card__title {
			font-size: 1.375rem;
		}

		.nexus-post-card__excerpt {
			@include truncate(4);
		}
	}

	@include respond-below(lg) {
		grid-template-columns: repeat(2, 1fr);

		.nexus-post-card--featured {
			grid-column: 1 / -1;
		}
	}

	@include respond-below(sm) {
		grid-template-columns: 1fr;

		.nexus-post-card--featured {
			grid-column: auto;
		}
	}
}

// -------------------------------------------------------------------------
// Single post
// -------------------------------------------------------------------------
.nexus-single-post {
	max-width: 800px;

	// Entry content
	.entry-content {
		font-size: 1.0625rem;
		line-height: 1.85;
		color: var(--nexus-text-secondary);

		h2, h3, h4, h5, h6 {
			color: var(--nexus-heading-color);
			margin-block: 2rem 0.75rem;
		}

		p { margin-block-end: 1.5rem; }

		a {
			color: var(--nexus-primary);
			text-decoration: underline;
		}

		blockquote {
			margin-inline: 0;
			padding: 1.5rem 1.5rem 1.5rem 2rem;
			border-inline-start: 4px solid var(--nexus-primary);
			background-color: var(--nexus-bg-subtle);
			border-radius: 0 var(--nexus-border-radius) var(--nexus-border-radius) 0;
			font-size: 1.125rem;
			font-style: italic;
			color: var(--nexus-heading-color);

			p:last-child { margin-block-end: 0; }

			cite {
				display: block;
				font-size: 0.875rem;
				font-style: normal;
				color: var(--nexus-text-muted);
				margin-block-start: 0.75rem;
			}
		}

		figure {
			margin-inline: 0;

			figcaption {
				font-size: 0.875rem;
				color: var(--nexus-text-muted);
				text-align: center;
				margin-block-start: 0.5rem;
			}
		}

		code {
			background-color: var(--nexus-bg-subtle);
			border: 1px solid var(--nexus-border-color);
			border-radius: var(--nexus-border-radius-sm);
			padding: 0.1em 0.4em;
			font-size: 0.875em;
		}

		pre {
			background-color: #0f172a;
			color: #e2e8f0;
			padding: 1.5rem;
			border-radius: var(--nexus-border-radius);
			overflow-x: auto;
			margin-block-end: 1.5rem;

			code {
				background: none;
				border: none;
				padding: 0;
				color: inherit;
				font-size: inherit;
			}
		}

		table {
			width: 100%;
			border-collapse: collapse;
			margin-block-end: 1.5rem;
			font-size: 0.9375rem;

			th, td {
				padding: 0.75rem 1rem;
				border: 1px solid var(--nexus-border-color);
				text-align: start;
			}

			th {
				background-color: var(--nexus-bg-subtle);
				font-weight: 700;
			}

			tbody tr:nth-child(even) {
				background-color: var(--nexus-bg-subtle);
			}
		}

		ul, ol {
			padding-inline-start: 1.5rem;
			margin-block-end: 1.5rem;

			li {
				margin-block-end: 0.35rem;
			}
		}

		img {
			max-width: 100%;
			height: auto;
			border-radius: var(--nexus-border-radius);
		}
	}
}

// -------------------------------------------------------------------------
// Post meta bar (single)
// -------------------------------------------------------------------------
.nexus-post-meta {
	display: flex;
	flex-wrap: wrap;
	align-items: center;
	gap: 1.25rem;
	font-size: 0.875rem;
	color: var(--nexus-text-muted);
	padding-block: 1rem;
	border-block: 1px solid var(--nexus-border-color);
	margin-block: 1.5rem;

	a {
		color: inherit;
		text-decoration: none;

		&:hover { color: var(--nexus-primary); }
	}

	&__item {
		display: flex;
		align-items: center;
		gap: 0.35rem;
	}
}

// -------------------------------------------------------------------------
// Author bio box
// -------------------------------------------------------------------------
.nexus-author-bio {
	display: grid;
	grid-template-columns: auto 1fr;
	gap: 1.5rem;
	align-items: start;
	background-color: var(--nexus-bg-subtle);
	border-radius: var(--nexus-border-radius-lg);
	padding: 2rem;
	margin-block: 3rem;

	&__avatar img {
		width: 80px;
		height: 80px;
		border-radius: 50%;
		object-fit: cover;
	}

	&__name {
		font-size: 1rem;
		font-weight: 700;
		margin-block-end: 0.5rem;
	}

	&__bio {
		font-size: 0.9375rem;
		line-height: 1.7;
		color: var(--nexus-text-secondary);
		margin-block-end: 0.75rem;
	}

	&__social {
		display: flex;
		gap: 0.75rem;

		a {
			color: var(--nexus-text-muted);
			font-size: 1rem;
			transition: color var(--nexus-transition-fast);

			&:hover { color: var(--nexus-primary); }
		}
	}

	@include respond-below(sm) {
		grid-template-columns: 1fr;
		text-align: center;

		&__social { justify-content: center; }
	}
}

// -------------------------------------------------------------------------
// Related posts
// -------------------------------------------------------------------------
.nexus-related-posts {
	margin-block-start: 3rem;

	&__title {
		font-size: 1.25rem;
		margin-block-end: 1.5rem;
	}

	&__grid {
		display: grid;
		grid-template-columns: repeat(3, 1fr);
		gap: 1.5rem;

		@include respond-below(md) { grid-template-columns: repeat(2, 1fr); }
		@include respond-below(sm) { grid-template-columns: 1fr; }
	}
}
