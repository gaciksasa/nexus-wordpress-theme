(function(){document.addEventListener("DOMContentLoaded",c);const d=window.nexusData||{};function c(){a(),u(),l(),f(),m(),p(),v(),h()}function a(){const t=document.getElementById("nexus-masthead");if(!t)return;const e=()=>{(window.scrollY||window.pageYOffset)>80?t.classList.add("is-sticky"):t.classList.remove("is-sticky")};window.addEventListener("scroll",e,{passive:!0})}function u(){const t=document.querySelector(".nexus-hamburger"),e=document.getElementById("nexus-mobile-menu"),s=document.querySelector(".nexus-mobile-nav__overlay"),n=document.querySelector(".nexus-mobile-nav__close");if(!t||!e)return;function o(){e.hidden=!1,e.classList.add("is-open"),t.setAttribute("aria-expanded","true"),s&&(s.hidden=!1,requestAnimationFrame(()=>s.classList.add("is-visible"))),document.body.style.overflow="hidden",e.focus()}function i(){e.classList.remove("is-open"),t.setAttribute("aria-expanded","false"),s&&(s.classList.remove("is-visible"),s.addEventListener("transitionend",()=>{s.hidden=!0},{once:!0})),document.body.style.overflow="",t.focus(),e.addEventListener("transitionend",()=>{e.hidden=!0},{once:!0})}t.addEventListener("click",o),n&&n.addEventListener("click",i),s&&s.addEventListener("click",i),document.addEventListener("keydown",r=>{r.key==="Escape"&&e.classList.contains("is-open")&&i()})}function l(){document.querySelectorAll(".nexus-menu-item--has-dropdown > a").forEach(e=>{const s=e.nextElementSibling;s&&(e.addEventListener("keydown",n=>{if(n.key==="ArrowDown"||n.key==="Enter"||n.key===" "){n.preventDefault(),e.setAttribute("aria-expanded","true");const o=s.querySelector("a");o&&o.focus()}}),s.addEventListener("keydown",n=>{n.key==="Escape"&&(e.setAttribute("aria-expanded","false"),e.focus())}),document.addEventListener("click",n=>{e.closest(".nexus-menu-item--has-dropdown").contains(n.target)||e.setAttribute("aria-expanded","false")}))})}function f(){const t=document.querySelector(".nexus-header__search-toggle"),e=document.getElementById("nexus-search-popup"),s=e&&e.querySelector(".nexus-search-popup__close"),n=e&&e.querySelector('input[type="search"]');if(!t||!e)return;function o(){e.hidden=!1,t.setAttribute("aria-expanded","true"),requestAnimationFrame(()=>e.classList.add("is-open")),n&&n.focus()}function i(){e.classList.remove("is-open"),t.setAttribute("aria-expanded","false"),e.addEventListener("transitionend",()=>{e.hidden=!0},{once:!0}),t.focus()}t.addEventListener("click",o),s&&s.addEventListener("click",i),e.addEventListener("click",r=>{r.target===e&&i()}),document.addEventListener("keydown",r=>{r.key==="Escape"&&e.classList.contains("is-open")&&i()})}function m(){if(!d.options||!d.options.backToTop)return;const t=document.querySelector(".nexus-back-to-top");t&&(window.addEventListener("scroll",()=>{window.scrollY>400?t.hidden=!1:t.hidden=!0},{passive:!0}),t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}))}function p(){if(!d.options||!d.options.preloader)return;const t=document.getElementById("nexus-preloader");t&&window.addEventListener("load",()=>{t.classList.add("is-loaded"),t.addEventListener("transitionend",()=>{t.remove()},{once:!0})})}function v(){const t=document.querySelectorAll(".nexus-header__dark-toggle");if(!t.length)return;function e(){return document.documentElement.classList.contains("nexus-dark")}function s(n){document.documentElement.classList.toggle("nexus-dark",n),t.forEach(o=>{o.setAttribute("aria-pressed",n?"true":"false")});try{localStorage.setItem("nexusDarkMode",n?"dark":"light")}catch{}}t.forEach(n=>{n.setAttribute("aria-pressed",e()?"true":"false"),n.addEventListener("click",()=>{s(!e())})})}function h(){const t=document.getElementById("nexus-reading-progress");if(!t)return;const e=t.querySelector(".nexus-reading-progress__fill");if(!e)return;const s=()=>{const n=window.scrollY||window.pageYOffset,o=document.documentElement.scrollHeight-window.innerHeight,i=o>0?n/o*100:0,r=Math.min(100,Math.max(0,i));e.style.width=r+"%",t.setAttribute("aria-valuenow",Math.round(r))};window.addEventListener("scroll",s,{passive:!0}),s()}})();
