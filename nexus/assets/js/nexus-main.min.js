(function(){document.addEventListener("DOMContentLoaded",c);const d=window.nexusData||{};function c(){a(),u(),l(),f(),m(),p(),v(),y()}function a(){const t=document.getElementById("nexus-masthead");if(!t)return;const e=()=>{(window.scrollY||window.pageYOffset)>80?t.classList.add("is-sticky"):t.classList.remove("is-sticky")};window.addEventListener("scroll",e,{passive:!0})}function u(){const t=document.querySelector(".nexus-hamburger"),e=document.getElementById("nexus-mobile-menu"),n=document.querySelector(".nexus-mobile-nav__overlay"),s=document.querySelector(".nexus-mobile-nav__close");if(!t||!e)return;function o(){e.hidden=!1,e.classList.add("is-open"),t.setAttribute("aria-expanded","true"),n&&(n.hidden=!1,requestAnimationFrame(()=>n.classList.add("is-visible"))),document.body.style.overflow="hidden",e.focus()}function i(){e.classList.remove("is-open"),t.setAttribute("aria-expanded","false"),n&&(n.classList.remove("is-visible"),n.addEventListener("transitionend",()=>{n.hidden=!0},{once:!0})),document.body.style.overflow="",t.focus(),e.addEventListener("transitionend",()=>{e.hidden=!0},{once:!0})}t.addEventListener("click",o),s&&s.addEventListener("click",i),n&&n.addEventListener("click",i),document.addEventListener("keydown",r=>{r.key==="Escape"&&e.classList.contains("is-open")&&i()})}function l(){document.querySelectorAll(".nexus-menu-item--has-dropdown > a").forEach(e=>{const n=e.nextElementSibling;n&&(e.addEventListener("keydown",s=>{if(s.key==="ArrowDown"||s.key==="Enter"||s.key===" "){s.preventDefault(),e.setAttribute("aria-expanded","true");const o=n.querySelector("a");o&&o.focus()}}),n.addEventListener("keydown",s=>{s.key==="Escape"&&(e.setAttribute("aria-expanded","false"),e.focus())}),document.addEventListener("click",s=>{e.closest(".nexus-menu-item--has-dropdown").contains(s.target)||e.setAttribute("aria-expanded","false")}))})}function f(){const t=document.querySelector(".nexus-header__search-toggle"),e=document.getElementById("nexus-search-popup"),n=e&&e.querySelector(".nexus-search-popup__close"),s=e&&e.querySelector('input[type="search"]');if(!t||!e)return;function o(){e.hidden=!1,t.setAttribute("aria-expanded","true"),requestAnimationFrame(()=>e.classList.add("is-open")),s&&s.focus()}function i(){e.classList.remove("is-open"),t.setAttribute("aria-expanded","false"),e.addEventListener("transitionend",()=>{e.hidden=!0},{once:!0}),t.focus()}t.addEventListener("click",o),n&&n.addEventListener("click",i),e.addEventListener("click",r=>{r.target===e&&i()}),document.addEventListener("keydown",r=>{r.key==="Escape"&&e.classList.contains("is-open")&&i()})}function m(){if(!d.options||!d.options.backToTop)return;const t=document.querySelector(".nexus-back-to-top");t&&(window.addEventListener("scroll",()=>{window.scrollY>400?t.hidden=!1:t.hidden=!0},{passive:!0}),t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}))}function p(){if(!d.options||!d.options.preloader)return;const t=document.getElementById("nexus-preloader");t&&window.addEventListener("load",()=>{t.classList.add("is-loaded"),t.addEventListener("transitionend",()=>{t.remove()},{once:!0})})}function v(){const t=document.querySelector(".nexus-header__dark-toggle");if(!t)return;function e(){return document.documentElement.classList.contains("nexus-dark")}function n(s){document.documentElement.classList.toggle("nexus-dark",s),t.setAttribute("aria-pressed",s?"true":"false");try{localStorage.setItem("nexusDarkMode",s?"dark":"light")}catch{}}t.setAttribute("aria-pressed",e()?"true":"false"),t.addEventListener("click",()=>{n(!e())})}function y(){const t=document.getElementById("nexus-reading-progress");if(!t)return;const e=t.querySelector(".nexus-reading-progress__fill");if(!e)return;const n=()=>{const s=window.scrollY||window.pageYOffset,o=document.documentElement.scrollHeight-window.innerHeight,i=o>0?s/o*100:0,r=Math.min(100,Math.max(0,i));e.style.width=r+"%",t.setAttribute("aria-valuenow",Math.round(r))};window.addEventListener("scroll",n,{passive:!0}),n()}})();
